/*!
The image region is typically an image tag and what's sent back to the server on serialization is the source of that
image. It allows draging/dropping images onto itself, and maintains a history so you can undo/redo your changes. Also
allows setting the image alignment.

Configuration:
  regions:image:
    mimeTypes: ['image/jpeg']                            # file types - overrides general uploading configuration
*/
(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Mercury.Region.Image=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.define("Mercury.Region.Image","image"),n.include(Mercury.Region.Modules.DropIndicator),n.include(Mercury.Region.Modules.DropItem),n.supported=!0,n.tag="img",n.events={mousedown:"onMousedown"},n.prototype.value=function(e){return e===null||typeof e=="undefined"?this.attr("src"):this.attr("src",e)},n.prototype.onMousedown=function(e){return this.prevent(e),this.$el.trigger("focus")},n.prototype.onDropFile=function(e){var t,n=this;return t=new(Mercury[this.config("interface:uploader")])(e,{mimeTypes:this.config("regions:image:mimeTypes")}),t.on("uploaded",function(e){return n.focus(),n.handleAction("file",e)})},n}(Mercury.Region),Mercury.Region.Image.addToolbar({general:{crop:["Crop Image"],resize:["Resize Image"]},alignment:{alignLeft:["Align Left"],alignRight:["Align Right"],alignTop:["Align Top"],alignMiddle:["Align Middle"],alignBottom:["Align Bottom"],alignNone:["Align None"]}}),Mercury.Region.Image.addData({align:function(e){return this.attr({align:e}),Mercury.trigger("resize")}}),Mercury.Region.Image.addAction({alignLeft:function(){return this.data({align:"left"})},alignRight:function(){return this.data({align:"right"})},alignTop:function(){return this.data({align:"top"})},alignMiddle:function(){return this.data({align:"middle"})},alignBottom:function(){return this.data({align:"bottom"})},alignNone:function(){return this.data({align:null})},file:function(e){if(e.isImage())return this.handleAction("image",{url:e.get("url")})},image:function(e){return this.value(e.get("url"))}}),Mercury.Region.Image.addContext({alignLeft:function(){return this.data("align")==="left"},alignRight:function(){return this.data("align")==="right"},alignTop:function(){return this.data("align")==="top"},alignMiddle:function(){return this.data("align")==="middle"},alignBottom:function(){return this.data("align")==="bottom"},alignNone:function(){return!this.data("align")}})}).call(this);